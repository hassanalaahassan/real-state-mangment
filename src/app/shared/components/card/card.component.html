<div
  class="property-card group animate-fade-in"
  [routerLink]="['/properties', property.id]">

  <!-- Card Header - Image -->
  <div class="card-image-container">
    <!-- Badges -->
    <div class="absolute top-3 left-3 z-10 flex flex-col gap-2">
      <!-- Featured Badge -->
      @if (property.isFeatured) {
      <span class="featured-badge animate-pulse">
        ⭐ Featured
      </span>
      }

      <!-- Status Badge -->
      <span [class]="'status-badge ' + getPropertyStatusColor(property.status)">
        {{ property.status === 'for-sale' ? 'For Sale' :
           property.status === 'for-rent' ? 'For Rent' : 'Sold' }}
      </span>
    </div>

    <!-- Favorite Button -->
    <button
      (click)="toggleFavorite($event)"
      class="absolute top-3 right-3 z-10 favorite-btn animate-bounce-in"
      [class.favorite-active]="isFavorite">
      <svg [class]="isFavorite ? 'fill-current text-red-500' : 'text-gray-400'"
           class="w-6 h-6 transition-all duration-300"
           fill="none"
           viewBox="0 0 24 24"
           stroke="currentColor">
        <path stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z" />
      </svg>
    </button>

    <!-- Image -->
    <div class="image-wrapper">
      <img
        [src]="property.images[0] || 'assets/images/default-property.jpg'"
        [alt]="property.title"
        (load)="onImageLoad()"
        [class.loaded]="isImageLoaded"
        class="property-image transition-transform duration-700 group-hover:scale-110">

      <!-- Loading Skeleton -->
      @if (!isImageLoaded) {
      <div class="image-skeleton animate-pulse"></div>
      }

      <!-- Image Overlay -->
      <div class="image-overlay"></div>
    </div>
  </div>

  <!-- Card Content -->
  <div class="card-content">
    <!-- Price -->
    <div class="price-section animate-slide-up">
      <h3 class="price-text">
        {{ formatPrice(property.price, property.currency) }}
      </h3>
      <p class="price-per-meter">
        {{ getPricePerSquareMeter() | number }} {{ property.currency }}/m²
      </p>
    </div>

    <!-- Title & Location -->
    <div class="title-section">
      <h4 class="property-title group-hover:text-realty-blue-600 transition-colors duration-300">
        {{ property.title }}
      </h4>
      <div class="location-section">
        <svg class="w-4 h-4 text-realty-gray-500" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" />
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M15 11a3 3 0 11-6 0 3 3 0 016 0z" />
        </svg>
        <span class="location-text">
          {{ property.location.district }}, {{ property.location.city }}
        </span>
      </div>
    </div>

    <!-- Property Details -->
    <div class="details-section">
      <!-- Type -->
      <div [class]="'property-type ' + getPropertyTypeColor(property.type)"
           class="animate-badge-in">
        <span class="type-icon">{{ getPropertyTypeIcon(property.type) }}</span>
        <span class="type-text capitalize">{{ property.type }}</span>
      </div>

      <!-- Details Grid -->
      <div class="details-grid">
        @if (property.area) {
        <div class="detail-item">
          <svg class="w-5 h-5 text-realty-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4" />
          </svg>
          <span>{{ property.area }} m²</span>
        </div>
        }

        @if (property.bedrooms) {
        <div class="detail-item">
          <svg class="w-5 h-5 text-realty-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" />
          </svg>
          <span>{{ property.bedrooms }} Bed</span>
        </div>
        }

        @if (property.bathrooms) {
        <div class="detail-item">
          <svg class="w-5 h-5 text-realty-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
          </svg>
          <span>{{ property.bathrooms }} Bath</span>
        </div>
        }

        @if (property.floor) {
        <div class="detail-item">
          <svg class="w-5 h-5 text-realty-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4" />
          </svg>
          <span>Floor {{ property.floor }}</span>
        </div>
        }
      </div>
    </div>

    <!-- Amenities -->
    @if (property.amenities && property.amenities.length > 0) {
    <div class="amenities-section">
      <div class="amenities-list">
        @for (amenity of property.amenities.slice(0, 3); track amenity) {
        <span class="amenity-badge">
          {{ amenity }}
        </span>
        }
        @if (property.amenities.length > 3) {
        <span class="amenity-more">
          +{{ property.amenities.length - 3 }} more
        </span>
        }
      </div>
    </div>
    }

    <!-- Actions -->
    <div class="actions-section">
      <button
        (click)="onContactRequest($event)"
        class="contact-btn animate-btn-pulse">
        <svg class="w-5 h-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z" />
        </svg>
        Contact Agent
      </button>

      <button
        [routerLink]="['/properties', property.id]"
        class="details-btn group-hover:bg-realty-blue-600 group-hover:text-white">
        View Details
        <svg class="w-4 h-4 ml-2 transition-transform duration-300 group-hover:translate-x-1"
             fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M14 5l7 7m0 0l-7 7m7-7H3" />
        </svg>
      </button>
    </div>
  </div>
</div>
